<%- include('../partials/header') %>

<section class="mb-4">
  <h2 class="section-title">Your Shopping Cart</h2>

  <% if (cartItems.length > 0) { %>
  <table class="cart-table">
    <thead>
      <tr>
        <th>Product</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Total</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <% cartItems.forEach(item => { %>
      <tr>
        <td>
          <div style="display: flex; align-items: center">
            <img
              src="<%= item.image_url || '/images/placeholder.jpg' %>"
              alt="<%= item.name %>"
              class="cart-item-image"
            />
            <div style="margin-left: 1rem">
              <h4><%= item.name %></h4>
            </div>
          </div>
        </td>
        <td>$<%= item.price.toFixed(2) %></td>
        <td>
          <div class="quantity-control">
            <button
              class="quantity-btn decrease"
              data-product-id="<%= item.product_id %>"
            >
              -
            </button>
            <input
              type="number"
              class="quantity-input"
              value="<%= item.quantity %>"
              min="1"
              data-product-id="<%= item.product_id %>"
            />
            <button
              class="quantity-btn increase"
              data-product-id="<%= item.product_id %>"
            >
              +
            </button>
          </div>
        </td>
        <td>$<%= (item.price * item.quantity).toFixed(2) %></td>
        <td>
          <button
            class="btn remove-item"
            data-product-id="<%= item.product_id %>"
            style="background-color: #e74a3b"
          >
            Remove
          </button>
        </td>
      </tr>
      <% }); %>
    </tbody>
  </table>

  <div class="cart-total">
    <p>Total: $<%= total.toFixed(2) %></p>
  </div>

  <div style="text-align: right">
    <a href="/products" class="btn btn-outline" style="margin-right: 1rem"
      >Continue Shopping</a
    >
    <a href="/checkout" class="btn">Proceed to Checkout</a>
  </div>
  <% } else { %>
  <div class="text-center">
    <p>Your cart is empty.</p>
    <a href="/products" class="btn">Browse Products</a>
  </div>
  <% } %>
</section>

<%- include('../partials/footer') %>
