<%- include('../partials/header') %>

<section class="mb-4" style="max-width: 700px; margin: 0 auto">
  <h2 class="section-title"><%= product ? 'Edit Product' : 'New Product' %></h2>

  <form method="POST" enctype="multipart/form-data">
    <div class="form-group">
      <label class="form-label">Name</label>
      <input class="form-control" name="name" value="<%= product ? product.name : '' %>" required />
    </div>
    <div class="form-group">
      <label class="form-label">Description</label>
      <textarea class="form-control" name="description" rows="4"><%= product ? product.description : '' %></textarea>
    </div>
    <div class="form-group">
      <label class="form-label">Price</label>
      <input class="form-control" type="number" step="0.01" name="price" value="<%= product ? product.price : '' %>" required />
    </div>
    <div class="form-group">
      <label class="form-label">Category ID</label>
      <input class="form-control" type="number" name="category_id" value="<%= product ? product.category_id : '' %>" required />
    </div>
    <div class="form-group">
      <label class="form-label">Image URL</label>
      <input class="form-control" name="image_url" value="<%= product ? (product.image_url || '') : '' %>" />
    </div>
    <div class="form-group">
      <label class="form-label">Upload Image</label>
      <input class="form-control" type="file" name="image" accept="image/*" id="imageInput" />
      <div class="mt-2" id="imagePreview">
        <% if (product && product.image_url) { %>
          <img src="<%= product.image_url %>" alt="Preview" style="max-width: 200px; height: auto; border-radius: 4px;" />
        <% } %>
      </div>
    </div>
    <div class="form-group">
      <label class="form-label">Active</label>
      <select class="form-control" name="is_active">
        <option value="true" <%= product && product.is_active ? 'selected' : '' %>>Yes</option>
        <option value="false" <%= product && !product.is_active ? 'selected' : '' %>>No</option>
      </select>
    </div>

    <button class="btn" type="submit"><%= product ? 'Update' : 'Create' %></button>
  </form>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function(){
    const input = document.getElementById('imageInput');
    const preview = document.getElementById('imagePreview');
    if (!input || !preview) return;
    input.addEventListener('change', function(){
      const file = this.files && this.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e){
        preview.innerHTML = '<img src="' + e.target.result + '" alt="Preview" style="max-width: 200px; height: auto; border-radius: 4px;" />';
      };
      reader.readAsDataURL(file);
    });
  });
  </script>

<%- include('../partials/footer') %>



